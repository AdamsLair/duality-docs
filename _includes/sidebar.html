<nav class="sidebar">
  <!-- Debug Output -->
  <ul class="debug">
    <li>Path: {{ page.path | jsonify }}</li>
    <li>URL: {{ page.url | jsonify }}</li>
    <li>Category: {{ page.category | jsonify }}</li>
    <li>Children: {{ page.children | jsonify }}</li>
    <li>Parent: {{ page.parent | jsonify }}</li>
  </ul>
  <a id="addPage" class="button" href="{{ site.github.repository_url }}">Add Page</a>
  <!-- If we are at a manual page, display parent and sub pages -->
  {% if page.parent %}
    {% assign parentUrl = page.parent | append '.html' %}
    {% assign parentPage = site.pages | where: 'url', parentUrl | first %}
    <ul class="debug">
      <li>Parent Page Path: {{ parentPage.path | jsonify }}</li>
      <li>Parent Page URL: {{ parentPage.url | jsonify }}</li>
    </ul>
    <a href="{{ site.baseurl }}{{ parentPage.url }}">&lt; Back to Parent</a>
    <h4>{{ page.title }}</h4>
  <!-- If we are at any other page, display top-level manual pages grouped by category. -->
  {% else %}
    {% assign sortedPages = site.pages | sort: 'displayOrder' %}
    {% for category in site.topLevelCategories %}
      <h4>{{ category.title }}</h4>
      <ul>
        {% for pageItem in sortedPages %}
          {% if pageItem.category and pageItem.category == category.id %}
            <li><a href="{{ site.baseurl }}{{ pageItem.url }}">{{ pageItem.title }}</a></li>
          {% endif %}
        {% endfor %}
      </ul>
    {% endfor %}
  {% endif %}
</nav>